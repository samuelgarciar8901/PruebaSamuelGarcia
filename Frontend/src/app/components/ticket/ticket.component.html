<div class="flex justify-center p-6 bg-gray-100 min-h-screen">

  <div class="w-7/12">

    <!-- Título y botón agregar -->
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">Tickets</h1>
      <button 
        (click)="toggleForm()"
        class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded"
      >
        {{ formVisible ? 'Cancelar' : 'Agregar Ticket' }}
      </button>
    </div>

    <!-- Formulario agregar/editar -->
    <div *ngIf="formVisible" class="mb-6 bg-white p-4 rounded shadow-md">
      <div class="mb-4">
        <label class="block mb-1 font-medium">Usuario</label>
        <input [(ngModel)]="ticket.usuario" type="text" class="w-full border border-gray-300 rounded px-2 py-1" />
      </div>
      <div class="mb-4">
        <label class="block mb-1 font-medium">Descripción</label>
        <textarea [(ngModel)]="ticket.descripcion" class="w-full border border-gray-300 rounded px-2 py-1"></textarea>
      </div>
      <div class="mb-4 flex items-center gap-2">
        <input [(ngModel)]="ticket.estatus" type="checkbox" id="estatus" class="h-4 w-4">
        <label for="estatus">Abierto</label>
      </div>
      <button 
        (click)="addTicket()" 
        class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded"
      >
        {{ editingId ? 'Actualizar' : 'Agregar' }}
      </button>
    </div>

    <!-- Grilla de tickets -->
    <div class="overflow-x-auto bg-white rounded shadow-md">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Usuario</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Descripción</th>
             <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Fecha Creación</th>
              <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Fecha Actualización</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Estatus</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Acciones</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <tr *ngFor="let t of paginatedTickets">
            <td class="px-4 py-2">{{ t.usuario }}</td>
            <td class="px-4 py-2">{{ t.descripcion }}</td>
            <td class="px-4 py-2">
              <span 
                class="px-2 py-1 rounded text-white text-xs" 
                [ngClass]="t.estatus ? 'bg-green-500' : 'bg-red-500'"
              >
                {{ t.estatus ? 'Abierto' : 'Cerrado' }}
              </span>
            </td>
             <td class="px-4 py-2">{{ t.fechaCreacion | date:'short' }}</td>
              <td class="px-4 py-2">{{ t.fechaActualizacion | date:'short' }}</td>
            <td class="px-4 py-2 flex gap-2">
              <button (click)="editTicket(t)" class="bg-yellow-400 hover:bg-yellow-500 text-white px-2 py-1 rounded text-sm">
                Editar
              </button>
              <button (click)="deleteTicket(t.id!)" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-sm">
                Eliminar
              </button>
            </td>
          </tr>
          <tr *ngIf="paginatedTickets.length === 0">
            <td colspan="4" class="text-center py-4 text-gray-500">No hay tickets</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Paginación -->
    <div class="flex justify-center mt-4 gap-2">
      <button 
        (click)="setPagina(paginaActual - 1)" 
        [disabled]="paginaActual === 1"
        class="px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50"
      >
        Anterior
      </button>

      <button 
        *ngFor="let p of [].constructor(totalPaginas); let i = index" 
        (click)="setPagina(i + 1)"
        [ngClass]="i + 1 === paginaActual ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'"
        class="px-3 py-1 rounded"
      >
        {{ i + 1 }}
      </button>

      <button 
        (click)="setPagina(paginaActual + 1)" 
        [disabled]="paginaActual === totalPaginas"
        class="px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50"
      >
        Siguiente
      </button>
    </div>

  </div>
</div>
